---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# envirotox

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

The goal of the envirotox R data package is to make alternative datasets from the [Envirotox database](http://www.envirotoxdatabase.org/) available for testing species sensitivity distribution code.

The datasets should not be used to make any conclusions about the toxicity of the chemicals in the database.

## Installation

To install the most recent version from [GitHub](https://github.com/poissonconsulting/flobr)
```r
# install.packages("remotes")
remotes::install_github("poissonconsulting/flobr")
```


## Demonstration

```{r}
library(envirotox)
library(ssdtools)
library(dplyr)
library(tidyr)

data <- envirotox::yanagihara_24_acute

data |>
  count(Chemical) |>
  pull(n) |>
  summary() |>
  print()

data <- data |>
  dplyr::nest_by(Chemical) |>
  dplyr::mutate(n = nrow(data), 
                ssd_fit = list(ssd_fit_dists(data, silent = TRUE)),
                ssd_hc = list(ssd_hc(ssd_fit, average = FALSE))) |>
  tidyr::unnest(ssd_hc) |>
  print()

data |>
  dplyr::group_by(Chemical) |>
  dplyr::arrange(desc(wt)) |>
  dplyr::slice(1) |>
  dplyr::ungroup() |>
  dplyr::count(dist) |>
  dplyr::arrange(desc(n)) |>
  print()

data |>
  dplyr::group_by(dist) |>
  dplyr::summarise(wt = mean(wt), .groups = "drop") |>
  dplyr::arrange(desc(wt)) |>
  print()
```
